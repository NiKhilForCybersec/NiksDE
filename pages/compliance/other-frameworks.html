<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PCI-DSS, SOC 2, HIPAA - Detection Engineering Mastery</title>
    <link rel="stylesheet" href="../../css/main.css">
</head>
<body>
    <div class="layout">
        <nav class="sidebar">
            <div class="sidebar-header">
                <a href="../../index.html" class="logo">
                    <svg class="logo-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"></path><path d="M2 17l10 5 10-5"></path><path d="M2 12l10 5 10-5"></path></svg>
                    <span>Detection Engineering</span>
                </a>
            </div>
            <div class="nav-sections">
                <div class="nav-section expanded" data-section="compliance">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 11l3 3L22 4"></path><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path></svg>
                            <span>Compliance & Frameworks</span>
                        </div>
                    </div>
                    <div class="nav-items">
                        <a href="framework-overview.html" class="nav-item">Framework Overview</a>
                        <a href="nist-csf.html" class="nav-item">NIST CSF</a>
                        <a href="nist-800-53.html" class="nav-item">NIST 800-53</a>
                        <a href="iso-27001.html" class="nav-item">ISO 27001</a>
                        <a href="gdpr.html" class="nav-item">GDPR & Privacy</a>
                        <a href="other-frameworks.html" class="nav-item active">PCI-DSS, SOC 2, HIPAA</a>
                        <a href="documentation.html" class="nav-item">Security Documentation</a>
                    </div>
                </div>
            </div>
        </nav>

        <main class="main-content">
            <div class="content">
                <nav class="breadcrumb">
                    <a href="../../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="framework-overview.html">Compliance</a>
                    <span class="separator">/</span>
                    <span class="current">PCI-DSS, SOC 2, HIPAA</span>
                </nav>

                <header class="page-header">
                    <h1>Industry-Specific Frameworks</h1>
                    <p class="subtitle">PCI-DSS for payment security, SOC 2 for service providers, and HIPAA for healthcare‚Äîdetection requirements for each framework.</p>
                </header>

                <section class="content-section">
                    <h2>PCI DSS 4.0</h2>
                    
                    <p>Payment Card Industry Data Security Standard applies to any organization that stores, processes, or transmits cardholder data.</p>

                    <h3>Detection-Relevant Requirements</h3>
                    <table class="styled-table">
                        <thead>
                            <tr>
                                <th>Requirement</th>
                                <th>Description</th>
                                <th>Detection Implementation</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>10.2</strong></td>
                                <td>Audit logs enabled</td>
                                <td>Log all access to cardholder data, security events</td>
                            </tr>
                            <tr>
                                <td><strong>10.4</strong></td>
                                <td>Logs reviewed daily</td>
                                <td>‚òÖ Automated SIEM analysis, daily review process</td>
                            </tr>
                            <tr>
                                <td><strong>10.6</strong></td>
                                <td>Time sync</td>
                                <td>NTP configuration for accurate timestamps</td>
                            </tr>
                            <tr>
                                <td><strong>10.7</strong></td>
                                <td>Log retention</td>
                                <td>90 days online, 1 year total</td>
                            </tr>
                            <tr>
                                <td><strong>11.4</strong></td>
                                <td>IDS/IPS</td>
                                <td>Network intrusion detection at CDE perimeter</td>
                            </tr>
                            <tr>
                                <td><strong>11.5</strong></td>
                                <td>File integrity monitoring</td>
                                <td>Detect changes to critical system files</td>
                            </tr>
                            <tr>
                                <td><strong>12.10</strong></td>
                                <td>Incident response</td>
                                <td>Detection triggers IR process</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>PCI DSS 10.4: Log Review Automation</h3>
                    <div class="code-block">
                        <div class="code-header">
                            <span>PCI-DSS Log Review Detection Rules</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code>// PCI DSS 10.4.1 - Automated mechanisms for log reviews

// 10.4.1.a - All security events
SecurityEvent
| where EventID in (4624, 4625, 4648, 4672, 4720, 4726, 4740)
| where Computer in ("CDE-Server1", "CDE-Server2", "Payment-App")
| summarize EventCount = count() by EventID, Computer, bin(TimeGenerated, 1h)

// 10.4.1.b - All logs from CDE systems
union SecurityEvent, Syslog, CommonSecurityLog
| where Computer has "CDE" or Computer has "Payment"
| where TimeGenerated > ago(24h)
| summarize LogSources = dcount(Computer), TotalEvents = count()

// 10.4.1.c - All CDE network events (Requirement 11.4)
CommonSecurityLog
| where DeviceVendor has_any ("Palo", "Cisco", "Fortinet")
| where DestinationIP has "10.1.2."  // CDE subnet
| where DeviceAction in ("block", "deny", "alert")
| project TimeGenerated, SourceIP, DestinationIP, DestinationPort, DeviceAction

// 10.4.2 - Critical system FIM alerts (Requirement 11.5)
SecurityEvent
| where EventID == 4663  // File access
| where ObjectName has_any ("payment", "cardholder", "pan")
| project TimeGenerated, Account, ObjectName, AccessMask</code></pre>
                    </div>

                    <div class="info-box warning">
                        <h4>‚ö†Ô∏è PCI DSS 4.0 Changes</h4>
                        <ul>
                            <li><strong>10.4.1.1:</strong> Automated mechanisms to perform audit log reviews (new)</li>
                            <li><strong>11.6:</strong> Detection of unauthorized changes (anti-tampering)</li>
                            <li><strong>12.3.1:</strong> Targeted risk analysis for flexible requirements</li>
                            <li>Effective March 2025 for new requirements</li>
                        </ul>
                    </div>
                </section>

                <section class="content-section">
                    <h2>SOC 2</h2>
                    
                    <p>SOC 2 (System and Organization Controls) is an audit standard for service providers, based on Trust Services Criteria.</p>

                    <h3>Trust Services Criteria</h3>
                    <table class="styled-table">
                        <thead>
                            <tr>
                                <th>Criteria</th>
                                <th>Focus</th>
                                <th>Detection Role</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Security (CC)</strong></td>
                                <td>Protection against unauthorized access</td>
                                <td>‚òÖ Core - all detection activities</td>
                            </tr>
                            <tr>
                                <td><strong>Availability (A)</strong></td>
                                <td>System availability commitments</td>
                                <td>Uptime monitoring, DoS detection</td>
                            </tr>
                            <tr>
                                <td><strong>Processing Integrity (PI)</strong></td>
                                <td>Complete, accurate processing</td>
                                <td>Data integrity alerts</td>
                            </tr>
                            <tr>
                                <td><strong>Confidentiality (C)</strong></td>
                                <td>Confidential information protection</td>
                                <td>DLP, unauthorized access detection</td>
                            </tr>
                            <tr>
                                <td><strong>Privacy (P)</strong></td>
                                <td>Personal information handling</td>
                                <td>PII access monitoring</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Key Common Criteria (CC) for Detection</h3>
                    <div class="code-block">
                        <div class="code-header">
                            <span>SOC 2 Common Criteria</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code>SOC 2 Security Controls Relevant to Detection:

CC6.1: Logical Access Security
‚îú‚îÄ‚îÄ Detect unauthorized access attempts
‚îú‚îÄ‚îÄ Monitor privileged access
‚îî‚îÄ‚îÄ Alert on access anomalies

CC6.6: Security Event Monitoring
‚îú‚îÄ‚îÄ ‚òÖ CORE: SIEM implementation
‚îú‚îÄ‚îÄ Security event detection
‚îú‚îÄ‚îÄ Alert generation and response
‚îî‚îÄ‚îÄ Log analysis and correlation

CC6.7: Transmission Security
‚îú‚îÄ‚îÄ Detect unencrypted transmissions
‚îú‚îÄ‚îÄ Monitor network anomalies
‚îî‚îÄ‚îÄ Alert on TLS/SSL issues

CC7.2: Monitor System Components
‚îú‚îÄ‚îÄ Continuous monitoring
‚îú‚îÄ‚îÄ Vulnerability detection
‚îú‚îÄ‚îÄ Configuration drift alerts

CC7.3: Evaluate Security Events
‚îú‚îÄ‚îÄ Incident classification
‚îú‚îÄ‚îÄ Root cause analysis
‚îî‚îÄ‚îÄ Trend analysis

CC7.4: Respond to Security Incidents
‚îú‚îÄ‚îÄ Incident response workflow
‚îú‚îÄ‚îÄ Containment actions
‚îî‚îÄ‚îÄ Recovery procedures</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>HIPAA</h2>
                    
                    <p>Health Insurance Portability and Accountability Act governs Protected Health Information (PHI) in healthcare organizations.</p>

                    <h3>HIPAA Security Rule - Detection Requirements</h3>
                    <table class="styled-table">
                        <thead>
                            <tr>
                                <th>Standard</th>
                                <th>Section</th>
                                <th>Detection Implementation</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Audit Controls</strong></td>
                                <td>¬ß164.312(b)</td>
                                <td>‚òÖ Implement mechanisms to record and examine PHI access</td>
                            </tr>
                            <tr>
                                <td><strong>Security Incidents</strong></td>
                                <td>¬ß164.308(a)(6)</td>
                                <td>Identify and respond to security incidents</td>
                            </tr>
                            <tr>
                                <td><strong>Access Controls</strong></td>
                                <td>¬ß164.312(a)</td>
                                <td>Detect unauthorized PHI access</td>
                            </tr>
                            <tr>
                                <td><strong>Integrity Controls</strong></td>
                                <td>¬ß164.312(c)</td>
                                <td>Detect unauthorized PHI alteration</td>
                            </tr>
                            <tr>
                                <td><strong>Log-in Monitoring</strong></td>
                                <td>¬ß164.308(a)(5)(ii)(C)</td>
                                <td>Monitor log-in attempts to PHI systems</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>HIPAA PHI Access Monitoring</h3>
                    <div class="code-block">
                        <div class="code-header">
                            <span>HIPAA Audit Control Detections</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code>// HIPAA ¬ß164.312(b) - Audit Controls for PHI Systems

// 1. Monitor EHR/EMR access
EHRAccessLogs
| where TimeGenerated > ago(24h)
| where Action in ("View", "Print", "Export", "Modify")
| summarize AccessCount = count(), 
            UniquePatients = dcount(PatientId)
            by UserId, Action
| where AccessCount > 100 or UniquePatients > 50
| extend AlertType = "HIPAA_UnusualPHIAccess"

// 2. After-hours PHI access
EHRAccessLogs
| where TimeGenerated > ago(24h)
| extend Hour = datetime_part("Hour", TimeGenerated)
| where Hour < 6 or Hour > 22  // Outside business hours
| where Action in ("View", "Export")
| project TimeGenerated, UserId, PatientId, Action
| extend AlertType = "HIPAA_AfterHoursPHIAccess"

// 3. Break-the-glass access review
EHRAccessLogs
| where AccessType == "Emergency"
| where TimeGenerated > ago(7d)
| project TimeGenerated, UserId, PatientId, Justification
| extend AlertType = "HIPAA_EmergencyAccessReview"

// 4. PHI database access logging (SQL)
AzureDiagnostics
| where ResourceType == "DATABASES"
| where database_name_s has_any ("patient", "medical", "health", "ehr")
| where statement_s has_any ("SELECT", "UPDATE", "DELETE")
| project TimeGenerated, client_ip_s, server_principal_name_s, 
          database_name_s, statement_s</code></pre>
                    </div>

                    <div class="info-box danger">
                        <h4>üö® HIPAA Breach Notification</h4>
                        <ul>
                            <li><strong>Under 500 individuals:</strong> Within 60 days of year-end</li>
                            <li><strong>500+ individuals:</strong> Within 60 days, media notification required</li>
                            <li>Rapid detection reduces breach scope and notification requirements</li>
                        </ul>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Framework Comparison</h2>

                    <table class="styled-table">
                        <thead>
                            <tr>
                                <th>Aspect</th>
                                <th>PCI DSS</th>
                                <th>SOC 2</th>
                                <th>HIPAA</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Scope</strong></td>
                                <td>Cardholder data</td>
                                <td>Service provider systems</td>
                                <td>PHI</td>
                            </tr>
                            <tr>
                                <td><strong>Log Review</strong></td>
                                <td>Daily (explicit)</td>
                                <td>Regular (CC6.6)</td>
                                <td>Required (¬ß164.312)</td>
                            </tr>
                            <tr>
                                <td><strong>Log Retention</strong></td>
                                <td>1 year (90 days online)</td>
                                <td>Per policy</td>
                                <td>6 years</td>
                            </tr>
                            <tr>
                                <td><strong>IDS/IPS</strong></td>
                                <td>Required (11.4)</td>
                                <td>Expected (CC6.6)</td>
                                <td>Addressable</td>
                            </tr>
                            <tr>
                                <td><strong>FIM</strong></td>
                                <td>Required (11.5)</td>
                                <td>Expected (CC7.2)</td>
                                <td>Addressable</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <section class="content-section">
                    <h2>Interview Preparation</h2>
                    
                    <div class="expandable">
                        <button class="expandable-header">
                            <span>Q: What PCI DSS requirements relate to SIEM?</span>
                            <span class="expand-icon">+</span>
                        </button>
                        <div class="expandable-content">
                            <p><strong>Key requirements:</strong></p>
                            <ul>
                                <li><strong>10.2:</strong> Log all access to cardholder data environments</li>
                                <li><strong>10.4:</strong> Review logs daily using automated mechanisms</li>
                                <li><strong>10.7:</strong> Retain logs for at least one year (90 days readily accessible)</li>
                                <li><strong>11.4:</strong> IDS/IPS at network perimeter and critical points</li>
                            </ul>
                            <p><strong>PCI DSS 4.0 adds:</strong> Requirement 10.4.1.1 explicitly requires automated log review mechanisms.</p>
                        </div>
                    </div>

                    <div class="expandable">
                        <button class="expandable-header">
                            <span>Q: How is SOC 2 different from ISO 27001?</span>
                            <span class="expand-icon">+</span>
                        </button>
                        <div class="expandable-content">
                            <p><strong>SOC 2:</strong></p>
                            <ul>
                                <li>Audit report (Type I or Type II)</li>
                                <li>US-focused (AICPA)</li>
                                <li>Trust Services Criteria</li>
                                <li>Service providers</li>
                            </ul>
                            <p><strong>ISO 27001:</strong></p>
                            <ul>
                                <li>Certification</li>
                                <li>International standard</li>
                                <li>ISMS-based</li>
                                <li>Any organization</li>
                            </ul>
                            <p><strong>For detection:</strong> Both require security monitoring. SOC 2 CC6.6 and ISO 27001 A.8.16 have similar detection requirements.</p>
                        </div>
                    </div>
                </section>

                <nav class="page-nav">
                    <a href="gdpr.html" class="nav-link prev">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"></polyline></svg>
                        GDPR & Privacy
                    </a>
                    <a href="documentation.html" class="nav-link next">
                        Security Documentation
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </a>
                </nav>
            </div>
        </main>
    </div>
    <script src="../../js/sidebar.js"></script>
</body>
</html>

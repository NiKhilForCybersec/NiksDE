<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulnerability Prioritization - Detection Engineering Mastery</title>
    <link rel="stylesheet" href="../../css/main.css">
</head>
<body>
    <div class="layout">
        <nav class="sidebar">
            <div class="sidebar-header">
                <a href="../../index.html" class="logo">
                    <svg class="logo-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"></path><path d="M2 17l10 5 10-5"></path><path d="M2 12l10 5 10-5"></path></svg>
                    <span>Detection Engineering</span>
                </a>
            </div>
            <div class="nav-sections">
                <div class="nav-section expanded" data-section="vuln-mgmt">
                    <div class="nav-section-header">
                        <div class="nav-section-title">
                            <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                            <span>Vulnerability Management</span>
                        </div>
                    </div>
                    <div class="nav-items">
                        <a href="fundamentals.html" class="nav-item">VM Fundamentals</a>
                        <a href="scanning.html" class="nav-item">Scanning Strategies</a>
                        <a href="prioritization.html" class="nav-item active">Prioritization</a>
                        <a href="remediation.html" class="nav-item">Remediation</a>
                        <a href="qualys-deep-dive.html" class="nav-item">Qualys Deep Dive</a>
                        <a href="tenable.html" class="nav-item">Tenable/Nessus</a>
                        <a href="metrics.html" class="nav-item">VM Metrics</a>
                        <a href="automation.html" class="nav-item">VM Automation</a>
                    </div>
                </div>
            </div>
        </nav>

        <main class="main-content">
            <div class="content">
                <nav class="breadcrumb">
                    <a href="../../index.html">Home</a>
                    <span class="separator">/</span>
                    <a href="fundamentals.html">Vulnerability Management</a>
                    <span class="separator">/</span>
                    <span class="current">Prioritization</span>
                </nav>

                <header class="page-header">
                    <h1>Vulnerability Prioritization</h1>
                    <p class="subtitle">Risk-based prioritization frameworks combining CVSS, threat intelligence, asset context, and business impact.</p>
                </header>

                <section class="content-section">
                    <h2>Prioritization Framework</h2>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span>Risk-Based Prioritization Model</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code>┌─────────────────────────────────────────────────────────────────┐
│                   Prioritization Formula                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                   │
│   PRIORITY = Exploitability × Impact × Exposure                  │
│                                                                   │
│   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│   │EXPLOITABILITY│  │    IMPACT    │  │   EXPOSURE   │         │
│   ├──────────────┤  ├──────────────┤  ├──────────────┤         │
│   │ • CISA KEV   │  │ • CVSS Score │  │ • Internet   │         │
│   │ • EPSS Score │  │ • Asset Value│  │   facing     │         │
│   │ • Public PoC │  │ • Data Class │  │ • Network    │         │
│   │ • Exploit    │  │ • Compliance │  │   segment    │         │
│   │   Maturity   │  │   Impact     │  │ • Controls   │         │
│   └──────────────┘  └──────────────┘  └──────────────┘         │
│                                                                   │
│   Example Scoring:                                               │
│   High Priority = (KEV + EPSS>0.5) × (Critical Asset) × (DMZ)   │
│                                                                   │
└─────────────────────────────────────────────────────────────────┘</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Priority Categories</h2>

                    <table class="styled-table">
                        <thead>
                            <tr>
                                <th>Priority</th>
                                <th>Criteria</th>
                                <th>SLA</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>P1 - Critical</strong></td>
                                <td>CISA KEV OR (CVSS ≥9 AND Internet-facing)</td>
                                <td>24-48 hours</td>
                                <td>Emergency patch, isolate if needed</td>
                            </tr>
                            <tr>
                                <td><strong>P2 - High</strong></td>
                                <td>EPSS >0.5 OR (CVSS ≥7 AND Critical Asset)</td>
                                <td>7 days</td>
                                <td>Prioritized patching</td>
                            </tr>
                            <tr>
                                <td><strong>P3 - Medium</strong></td>
                                <td>CVSS 4-6.9 OR (CVSS ≥7 AND Internal)</td>
                                <td>30 days</td>
                                <td>Scheduled patching</td>
                            </tr>
                            <tr>
                                <td><strong>P4 - Low</strong></td>
                                <td>CVSS <4 AND No Active Exploitation</td>
                                <td>90 days</td>
                                <td>Regular maintenance</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <section class="content-section">
                    <h2>Key Intelligence Sources</h2>

                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>CISA KEV</h4>
                            <p>Known Exploited Vulnerabilities catalog</p>
                            <ul>
                                <li>Active exploitation confirmed</li>
                                <li>Federal remediation deadlines</li>
                                <li>Highest priority signal</li>
                            </ul>
                        </div>
                        <div class="comparison-card">
                            <h4>EPSS</h4>
                            <p>Exploit Prediction Scoring System</p>
                            <ul>
                                <li>Probability of exploitation</li>
                                <li>ML-based prediction</li>
                                <li>30-day forecast</li>
                            </ul>
                        </div>
                        <div class="comparison-card">
                            <h4>Vendor Threat Intel</h4>
                            <p>Platform-specific intelligence</p>
                            <ul>
                                <li>Qualys TruRisk</li>
                                <li>Tenable VPR</li>
                                <li>Microsoft severity</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Automated Prioritization</h2>

                    <div class="code-block">
                        <div class="code-header">
                            <span>Python - Risk Score Calculator</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <pre><code>def calculate_priority(vuln: dict, asset: dict) -> str:
    """Calculate vulnerability priority based on multiple factors"""
    
    # Factor 1: Exploitability
    exploitability = 0
    if vuln.get('in_kev'):
        exploitability = 100
    elif vuln.get('epss_score', 0) > 0.5:
        exploitability = 80
    elif vuln.get('public_exploit'):
        exploitability = 60
    else:
        exploitability = vuln.get('cvss', 0) * 10
    
    # Factor 2: Impact
    impact = vuln.get('cvss', 5) * 10
    if asset.get('criticality') == 'critical':
        impact *= 1.5
    if asset.get('data_classification') == 'confidential':
        impact *= 1.3
    
    # Factor 3: Exposure
    exposure = 50  # baseline
    if asset.get('internet_facing'):
        exposure = 100
    elif asset.get('dmz'):
        exposure = 80
    elif asset.get('internal_only'):
        exposure = 30
    
    # Calculate composite score
    risk_score = (exploitability * 0.4) + (impact * 0.35) + (exposure * 0.25)
    
    # Determine priority
    if vuln.get('in_kev') or risk_score >= 80:
        return 'P1-Critical'
    elif risk_score >= 60:
        return 'P2-High'
    elif risk_score >= 40:
        return 'P3-Medium'
    else:
        return 'P4-Low'</code></pre>
                    </div>
                </section>

                <section class="content-section">
                    <h2>Interview Preparation</h2>
                    
                    <div class="expandable">
                        <button class="expandable-header">
                            <span>Q: A CVSS 10.0 vulnerability and a CVSS 7.5 with active exploitation - which do you prioritize?</span>
                            <span class="expand-icon">+</span>
                        </button>
                        <div class="expandable-content">
                            <p><strong>Answer:</strong> The CVSS 7.5 with active exploitation should be prioritized.</p>
                            <p><strong>Reasoning:</strong></p>
                            <ul>
                                <li>Active exploitation = immediate, real-world threat</li>
                                <li>CVSS measures theoretical severity, not actual risk</li>
                                <li>A CVSS 10.0 may never be exploited if complex or requires local access</li>
                                <li>An actively exploited vulnerability has proven attacker interest</li>
                            </ul>
                            <p>This is why frameworks like CISA KEV and EPSS exist - to add exploitability context to raw CVSS scores.</p>
                        </div>
                    </div>
                </section>

                <nav class="page-nav">
                    <a href="scanning.html" class="nav-link prev">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"></polyline></svg>
                        Scanning Strategies
                    </a>
                    <a href="remediation.html" class="nav-link next">
                        Remediation
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </a>
                </nav>
            </div>
        </main>
    </div>
    <script src="../../js/sidebar.js"></script>
</body>
</html>
